<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  let paddleX = (canvas.width - 80) / 2;
  let ballX = canvas.width / 2;
  let ballY = canvas.height / 2;
  let ballRadius = 8;
  let ballSpeedX = 3;
  let ballSpeedY = -3;
  let score = 0;
  let recorde = parseInt(localStorage.getItem("recorde")) || 0;
  document.getElementById("recorde").textContent = recorde;

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Bolinha
    ctx.beginPath();
    ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
    ctx.fillStyle = "#ff69b4";
    ctx.fill();
    ctx.closePath();

    // Barra
    ctx.fillStyle = "#222";
    ctx.fillRect(paddleX, canvas.height - 20, 80, 10);

    ballX += ballSpeedX;
    ballY += ballSpeedY;

    if (ballX + ballRadius > canvas.width || ballX - ballRadius < 0) ballSpeedX *= -1;
    if (ballY - ballRadius < 0) ballSpeedY *= -1;

    if (
      ballY + ballRadius >= canvas.height - 20 &&
      ballX >= paddleX &&
      ballX <= paddleX + 80
    ) {
      ballSpeedY *= -1;
      score++;
      document.getElementById("score").textContent = score;

      if (score > recorde) {
        recorde = score;
        localStorage.setItem("recorde", recorde);
        document.getElementById("recorde").textContent = recorde;
      }

      if (score % 5 === 0) {
        ballSpeedX += ballSpeedX > 0 ? 0.5 : -0.5;
        ballSpeedY += ballSpeedY > 0 ? 0.5 : -0.5;
      }
    }

    if (ballY + ballRadius > canvas.height) {
      alert(`Game Over!\nPontuação: ${score}\nRecorde: ${recorde}`);
      document.location.reload();
    }

    requestAnimationFrame(draw);
  }

  // Movimento com mouse
  document.addEventListener("mousemove", (e) => {
    const rect = canvas.getBoundingClientRect();
    paddleX = e.clientX - rect.left - 40;
  });

  // Movimento com dedo (toque)
  document.addEventListener("touchmove", (e) => {
    e.preventDefault(); // impedir rolagem da tela
    const rect = canvas.getBoundingClientRect();
    paddleX = e.touches[0].clientX - rect.left - 40;
  }, { passive: false });

  // Impedir que a barra saia da tela
  setInterval(() => {
    if (paddleX < 0) paddleX = 0;
    if (paddleX + 80 > canvas.width) paddleX = canvas.width - 80;
  }, 10);

  draw();
</script>